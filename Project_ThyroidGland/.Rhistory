geom_line(aes(y = SvO2 - mean(SvO2, na.rm = TRUE), col = "SvO2")) +
ggtitle("Evolution of computed SGF, with random adjusted evolution (zero-centered)") +
labs (x = "Time (s)", y = NULL,  col = NULL)+
geom_ribbon(aes(ymin = 75, ymax = 85), fill = "gray90", alpha = 0.5) +  # Shade the area between y = 75 and y = 85
geom_hline(yintercept = c(75, 85), linetype = "dashed") +  # Add dashed horizontal lines at y = 75 and y = 85
theme_minimal()
ggsave(paste0(path, sep="", name ,"_mean.jpg"), plot2, width = 14, height = 7)
library(tidyverse)
#list = ls()
#list = list[grep("MFE", list)]
df = MFE_Sine_Amp20.Off80[-1,]
name = "MFE_Sine_Amp20.Off80"
colnames(df) = c( "SvO2", "SGF", "Time")
df[] = lapply(df, function(x) as.numeric(gsub(",", ".", x)))
lapply(df, function(var) class(var))
#saveRDS(file = "./MFE_MedSine_11", df)
plot1 = df[] %>% ggplot(aes(x = Time)) +
geom_line(aes(y = SGF, col ="Sweep Gas Flow")) +
#geom_line(aes(y = Vmean100, col = "Mean accross 100 output values"))+
geom_line(aes(y = SvO2, col = "SvO2")) +
ggtitle("Evolution of computed SGF, with a randomly adjusted evolution") +
labs (x = "Time (s)", y = NULL,  col = NULL)+
geom_ribbon(aes(ymin = 75, ymax = 85), fill = "gray90", alpha = 0.5) +  # Shade the area between y = 75 and y = 85
geom_hline(yintercept = c(75, 85), linetype = "dashed") +  # Add dashed horizontal lines at y = 75 and y = 85
theme_minimal()
path = "C:/Users/thoma/Desktop/Graphs/"
ggsave(paste0(path, sep="", name ,".jpg"), plot1, width = 14, height = 6)
plot2 = df[] %>% ggplot(aes(x = Time)) +
geom_line(aes(y = SGF - mean(SGF, na.rm = TRUE), col ="Sweep Gas Flow")) +
#geom_line(aes(y = Vmean100, col = "Mean accross 100 output values"))+
geom_line(aes(y = SvO2 - mean(SvO2, na.rm = TRUE), col = "SvO2")) +
ggtitle("Evolution of computed SGF, with random adjusted evolution (zero-centered)") +
labs (x = "Time (s)", y = NULL,  col = NULL)+
geom_ribbon(aes(ymin = -5, ymax = +5), fill = "gray90", alpha = 0.5) +  # Shade the area between y = 75 and y = 85
geom_hline(yintercept = c(75, 85), linetype = "dashed") +  # Add dashed horizontal lines at y = 75 and y = 85
theme_minimal()
ggsave(paste0(path, sep="", name ,"_mean.jpg"), plot2, width = 14, height = 7)
library(tidyverse)
#list = ls()
#list = list[grep("MFE", list)]
df = MFE_Sine_Amp20.Off80[-1,]
name = "MFE_Sine_Amp20.Off80"
colnames(df) = c( "SvO2", "SGF", "Time")
df[] = lapply(df, function(x) as.numeric(gsub(",", ".", x)))
lapply(df, function(var) class(var))
#saveRDS(file = "./MFE_MedSine_11", df)
plot1 = df[] %>% ggplot(aes(x = Time)) +
geom_line(aes(y = SGF, col ="Sweep Gas Flow")) +
#geom_line(aes(y = Vmean100, col = "Mean accross 100 output values"))+
geom_line(aes(y = SvO2, col = "SvO2")) +
ggtitle("Evolution of computed SGF, with a randomly adjusted evolution") +
labs (x = "Time (s)", y = NULL,  col = NULL)+
geom_ribbon(aes(ymin = 75, ymax = 85), fill = "gray90", alpha = 0.5) +  # Shade the area between y = 75 and y = 85
geom_hline(yintercept = c(75, 85), linetype = "dashed") +  # Add dashed horizontal lines at y = 75 and y = 85
theme_minimal()
path = "C:/Users/thoma/Desktop/Graphs/"
ggsave(paste0(path, sep="", name ,".jpg"), plot1, width = 14, height = 6)
plot2 = df[] %>% ggplot(aes(x = Time)) +
geom_line(aes(y = SGF - mean(SGF, na.rm = TRUE), col ="Sweep Gas Flow")) +
#geom_line(aes(y = Vmean100, col = "Mean accross 100 output values"))+
geom_line(aes(y = SvO2 - mean(SvO2, na.rm = TRUE), col = "SvO2")) +
ggtitle("Evolution of computed SGF, with random adjusted evolution (zero-centered)") +
labs (x = "Time (s)", y = NULL,  col = NULL)+
geom_ribbon(aes(ymin = -5, ymax = +5), fill = "gray90", alpha = 0.5) +  # Shade the area between y = 75 and y = 85
geom_hline(yintercept = c(-5, +5), linetype = "dashed") +  # Add dashed horizontal lines at y = 75 and y = 85
theme_minimal()
ggsave(paste0(path, sep="", name ,"_mean.jpg"), plot2, width = 14, height = 7)
MFE_Sine_80.17 <- read.delim2("C:/Users/thoma/Desktop/Data/MFE_Sine_80-17.txt", header=FALSE)
View(MFE_Sine_80.17)
write.csv(MFE_Sine_80.17, "C:/Users/thoma/Desktop/Data/MFE_Sine_80.17.csv", row.names=FALSE)
View(MFE_LowOxy_1031)
install.packages("readxl")
expData1 = read_excel("D:\Polytech\Master Thesis\Master-Thesis\8. Modeling\DataAnalysis\Data\expData1ChangeSvO2calibration.xlsx")
expData1 = read_excel("D:/Polytech/Master Thesis/Master-Thesis/8. Modeling/DataAnalysis/Data/expData1ChangeSvO2calibration.xlsx")
library("tidyverse")
library("readxl")
expData1 = read_excel("D:/Polytech/Master Thesis/Master-Thesis/8. Modeling/DataAnalysis/Data/expData1ChangeSvO2calibration.xlsx")
expData2 = read_excel("D:/Polytech/Master Thesis/Master-Thesis/8. Modeling/DataAnalysis/Data/expData2Increasedtonus(phenylephrine).xlsx")
View(expData1)
plot(expData1$tfig, expData1$SvO2)
plot(expData2$tfig, expData2$SvO2)
plot(expData2$tfig * 3600, expData2$SvO2)
plot(expData2$tfig * 60, expData2$SvO2)
expData1 %>% ggplot(aes( x= tfig)) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (s)", y = SvO2,  col = NULL)+
theme_minimal()
expData1 %>% ggplot(aes( x= tfig)) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (s)", y = "SvO2",  col = NULL)+
theme_minimal()
expData1 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
theme_minimal()
expData1 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)
expData1 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal()
expData2 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal()
View(expData2)
expData1 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal()
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal()
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60, color = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal()
expData1 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
expData1 %>% ggplot(aes( x= tfig * 60, col = "#0B65F9")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
expData1 %>% ggplot(aes( x= tfig * 60, col = "#0B65F9")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
expData1 %>% ggplot(aes( x= tfig * 60, col = "#0B65F9")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
expData1 %>% ggplot(aes( x= tfig * 60, col = "#0B65F9")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
expData1 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
expData1 %>% ggplot(aes( x= tfig * 60, col = "#FE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
# Data visualisation of real-life SvO2 signal
library("tidyverse")
library("readxl")
## plot 1:
expData1 = read_excel("D:/Polytech/Master Thesis/Master-Thesis/8. Modeling/DataAnalysis/Data/expData1ChangeSvO2calibration.xlsx")
plot(expData1$tfig, expData1$SvO2)
expData1 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60, col = "#DE2F56")) +
geom_point(aes(y = SvO2)) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, , col = "#DE2F56")) +
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
geom_point(aes(y = expData1$MeasuredFlowRate, col = "#0B65F9"))
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2 %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
expData2[:,50]
expData2[,50]
expData2[50,]
expData2[0:50,]
## plot 2:
expData2[0:50,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2[0:500,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2[0:150,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2[0:200,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2[0:175,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2[0:175,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2[0:150,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 2:
expData2[0:160,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2, col = "#DE2F56")) +
#  geom_point(aes(y = MeasuredFlowRate, col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[0:160,] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2 - mean(expData2$SvO2), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(expData2$MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = SvO2 - mean(expData2$SvO2), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(expData2$MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 5 * (SvO2 - mean(expData2$SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(expData2$MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 10 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(expData2$MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 10 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), fill = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2")+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
,  col = NULL
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal()
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), fill = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), fill = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), label = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), label = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
col
## plot 3:
expData2[] %>% ggplot(aes( x= tfig * 60)) +
geom_point(aes(y = 0.1 * (SvO2 - mean(SvO2)), col = "#DE2F56")) +
geom_point(aes(y = MeasuredFlowRate - mean(MeasuredFlowRate), col = "#0B65F9"))+
labs (x = "Time (min)", y = "SvO2",  col = NULL)+
#  ylim(0,100)+
theme_minimal() +
theme(legend.position = "none")
library(tidyverse)
setwd("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland")
RNA_read = read_tsv("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland/Data_ThyroidGland/OG/RNA_read_counts.tsv")
morphological_counts = read_tsv("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland/Data_ThyroidGland/OG/morphological_counts_lunit_dino.tsv")
clinical_data = read_tsv("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland/Data_ThyroidGland/OG/clinical_data.tsv")
rownames(RNA_read) = RNA_read$Name
df = RNA_read %>% select_if(is.numeric)
rownames(df) = RNA_read$Name
med_avg = apply(df,1, function(var) mad(var, na.rm = TRUE))
hist(med_avg)
hist(log(med_avg))
max(med_avg)
# Suspectly high value --> too
pos.max = which.max(med_avg)
#View(t(df[pos.max,])[,1])
hist(t(df[pos.max ,])[,1])
hist(log10(t(df[pos.max ,])[,1]))
---
title: "BINF-F401"
knitr::opts_chunk$set(echo = TRUE)
library(grid)
library(tidyverse)
library(corrplot)
library(grid)
library(gridExtra)
library(caret)
library(FactoMineR)
library("factoextra")
library(backports)
p_value = .05
setwd("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland")
morphological_counts = read_tsv("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland/Data_ThyroidGland/OG/morphological_counts_lunit_dino.tsv")
setwd("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland")
morphological_counts = read_tsv("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland/Data_ThyroidGland/OG/morphological_counts_lunit_dino.tsv")
RNA_read = read_tsv("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland/Data_ThyroidGland/OG/RNA_read_counts.tsv")
rownames(RNA_read) = RNA_read$Name
df = RNA_read %>% select_if(is.numeric)
rownames(df) = RNA_read$Name
med_avg = apply(df,1, function(var) mad(var, na.rm = TRUE))
rownames(RNA_read) = RNA_read$Name
df = RNA_read %>% select_if(is.numeric)
rownames(df) = RNA_read$Name
maxs = apply(df,1, function(var) max(var, na.rm = TRUE))
hist(maxs)
maxs = apply(df,1, function(var) max(var, na.rm = TRUE))
hist(log(maxs))
med_avg = apply(df,1, function(var) mad(var, na.rm = TRUE))
hist(log(med_avg))
hist(med_avg)
hist(log(med_avg))
hist((maxs))
hist(maxs)
hist(log(maxs))
hist(log10(maxs))
hist(log10(med_avg))
hist(log10(med_avg + 1))
hist(log10(maxs + 1))
hist(log10(med_avg ))
hist(log10(med_avg + 1))
hist(log10(med_avg))
hist(log10(med_avg + 1))
hist(log10(med_avg))
hist(log10(med_avg + 1))
hist(log10(med_avg))
med_avg = apply(df,1, function(var) mad(var, na.rm = TRUE))
hist(log10(med_avg + 1))
hist(log10(med_avg))
View(morphological_counts)
View(RNA_read)
10**1.5
101.5
10^1.5
median = apply(df,1, function(var) median(var, na.rm = TRUE))
median = apply(df,1, function(var) median(var, na.rm = TRUE))
hist(log10(median + 1))
high_mad = med_avg > 10**1.5
high_expr = maxs > 10**2.5
high_median = median > 10**2
View(df)
sum(high_mad & high_expr)
(high_mad & high_expr)
df[:,1]
df[,1]
df[1]
df[1,]
print(sum(cond))
cond = (high_mad & high_expr)
print(sum(cond))
filtered_df = df[, cond ]
filtered_df = df[cond, ]
cts = df[cond, ]
