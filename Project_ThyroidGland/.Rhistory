guides(fill = "none") +
theme_minimal()
sum = summary(clin_num[[var]])
sum = sum[c(4,1,6)]
texts = c()
i = 1
for(name in names(sum)){
texts[i] = paste0(name,sep = " ", round(sum[i], digits = 2), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
summary(clin_num[[var]])
clin_num[[var]]
clin_bin[[var]]
summary(clin_bin[[var]])
levels(clinical_data[[clin_bin]])
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = "#DE2F56"), bins = 20) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
names = levels(clinical_data[[clin_bin]])
texts = c()
i = 1
for(name in names(sum)){
texts[i] = paste0(name,sep = " ", round(sum[i], digits = 2), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = "#DE2F56"), bins = 20) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
names = levels(clinical_data[[clin_bin]])
levels(clinical_data[[clin_bin]])
clinical_data[[clin_bin]]
clinical_data[[var]]
levels(clinical_data[[var]])
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = "#DE2F56"), bins = 20) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = "#DE2F56")) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], label = var)) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = var)) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = clinical_data[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = clinical_data[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = clinical_data[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")))
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2)
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = clinical_data[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2, widths = c(2,1))
}
clin_num = clinical_data %>% dplyr::select("AGE", "HGHT", "WGHT", "BMI", "TRISCHD")
for(var in clin_num %>% colnames()){
hist = clinical_data %>% ggplot() +
geom_histogram(aes(x = clinical_data[[var]], fill = "#DE2F56"), bins = 20) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
guides(fill = "none") +
theme_minimal()
sum = summary(clin_num[[var]])
sum = sum[c(4,1,6)]
texts = c()
i = 1
for(name in names(sum)){
texts[i] = paste0(name,sep = " ", round(sum[i], digits = 2), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2 )
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT", "DTHHRDY")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = clinical_data[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2, widths = c(2,1))
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT", "DTHHRDY")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
clinical_data$DTHHRDY = as.factor(clinical_data$DTHHRDY)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = clinical_data[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count") +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2, widths = c(2,1))
}
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT", "DTHHRDY")
clinical_data$SEX = as.factor(clinical_data$SEX)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT = as.factor(clinical_data$DTHVNT)
clinical_data$DTHHRDY = as.factor(clinical_data$DTHHRDY)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clinical_data[[var]], fill = clinical_data[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count", fill = NULL) +
theme_minimal()
names = levels(clinical_data[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clinical_data[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2, widths = c(2,1))
}
cor = cor(clinical_data %>% select(clinical_numeric), use = "pairwise.complete.obs")
clin_bin = clinical_data %>% dplyr::select("SEX", "COHORT", "DTHVNT", "DTHHRDY")
clin_bin$SEX = as.factor(clinical_data$SEX)
clin_bin$COHORT = as.factor(clinical_data$COHORT)
clin_bin$DTHVNT = as.factor(clinical_data$DTHVNT)
clin_bin$DTHHRDY = as.factor(clinical_data$DTHHRDY)
for(var in clin_bin %>% colnames()){
hist = clin_bin %>% ggplot() +
geom_bar(aes(x = clin_bin[[var]], fill = clin_bin[[var]])) +
ggtitle(paste("Histogram of ", var)) +
labs( x = var, y = "Count", fill = NULL) +
theme_minimal()
names = levels(clin_bin[[var]])
texts = c()
i = 1
for(name in names){
texts[i] = paste0(name,":",sep = " ", sum( clin_bin[[var]] == name ,na.rm = TRUE), "\n")
i = i + 1
}
grid.arrange(hist, textGrob(paste(texts, collapse = " ")), ncol = 2, widths = c(2,1))
}
setwd("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland")
clinical_data = read_tsv("D:/Polytech/MA2 2023-2024/Q2/Genomics/Project_ThyroidGland/Data_ThyroidGland/OG/clinical_data.tsv")
clinical_data$DTHHRDY = as.factor(clinical_data$DTHHRDY)
clinical_data$COHORT = as.factor(clinical_data$COHORT)
clinical_data$DTHVNT[clinical_data$DTHVNT == 99] = NA
clinical_class <- sapply(clinical_data, class)
clinical_numeric =  clinical_data %>% select(where(is.numeric)) %>% colnames()
cor = cor(clinical_data %>% select(clinical_numeric), use = "pairwise.complete.obs")
Mtest = cor.mtest(clinical_data %>% select(clinical_numeric),
conf.level = p_value)
cor[Mtest$p > p_value] = 0
cairo_pdf(paste(path_out, "clinical_correlations.pdf", sep = "/"), onefile = T)
cor = cor(clinical_data %>% select(clinical_numeric), use = "pairwise.complete.obs")
Mtest = cor.mtest(clinical_data %>% select(clinical_numeric),
conf.level = p_value)
cor[Mtest$p > p_value] = 0
corrplot <- corrplot::corrplot(corr = cor, method = "number",
diag = FALSE,
tl.cex = .75, tl.col = "black",
mar = c(0,0,1,0), type = 'upper',
col = colorRampPalette(c('#DE2F56','white','#0B65F9'))(100))
highest_cor = cor
# Keep high correlations
highest_cor[abs(cor) < 0.2] = 0
# Keep significant correlations
highest_cor[(Mtest$p) > 0.05] = 0
# Remove self correlations
highest_cor[abs(cor) == 1] = 0
cor_list = data.frame(var.x = character(0), var.y  = character(0),
cor = numeric(0), p = numeric(0))
var.y_list = colnames(cor)
for(var.x in colnames(cor)){
for(var.y in var.y_list){
if(var.x != var.y){
new_row = data.frame(var.x = var.x,
var.y = var.y,
cor = cor(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs"),
p = cor.test(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs")$p.value)
if(new_row$p < 0.05 & abs(new_row$cor) > 0.15){
cor_list = rbind(cor_list, new_row)
}
}
}
var.y_list = var.y_list[-which(var.y_list == var.x)]
}
for(comp in 1:nrow(cor_list)){
var.x = cor_list[comp, "var.x"]
var.y = cor_list[comp, "var.y"]
plot = clinical_data %>% ggplot() + geom_point(aes( x = clinical_data[[var.x]], y = clinical_data[[var.y]],
alpha = 0.5),
#position = position_jitter(w = 0, h = 0),
col = '#DE2F56') +
xlab(var.x) + ylab(var.y) +
theme_minimal()
print(plot)
}
highest_cor = cor
# Keep high correlations
highest_cor[abs(cor) < 0.2] = 0
# Keep significant correlations
highest_cor[(Mtest$p) > 0.05] = 0
# Remove self correlations
highest_cor[abs(cor) == 1] = 0
cor_list = data.frame(var.x = character(0), var.y  = character(0),
cor = numeric(0), p = numeric(0))
var.y_list = colnames(cor)
for(var.x in colnames(cor)){
for(var.y in var.y_list){
if(var.x != var.y){
new_row = data.frame(var.x = var.x,
var.y = var.y,
cor = cor(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs"),
p = cor.test(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs")$p.value)
if(new_row$p < 0.05 & abs(new_row$cor) > 0.15){
cor_list = rbind(cor_list, new_row)
}
}
}
var.y_list = var.y_list[-which(var.y_list == var.x)]
}
for(comp in 1:nrow(cor_list)){
var.x = cor_list[comp, "var.x"]
var.y = cor_list[comp, "var.y"]
plot = clinical_data %>% ggplot() + geom_point(aes( x = clinical_data[[var.x]], y = clinical_data[[var.y]],
alpha = 0.5),
position = position_jitter(w = 0, h = 0),
col = '#DE2F56') +
xlab(var.x) + ylab(var.y) +
theme_minimal()
print(plot)
}
highest_cor = cor
# Keep high correlations
highest_cor[abs(cor) < 0.2] = 0
# Keep significant correlations
highest_cor[(Mtest$p) > 0.05] = 0
# Remove self correlations
highest_cor[abs(cor) == 1] = 0
cor_list = data.frame(var.x = character(0), var.y  = character(0),
cor = numeric(0), p = numeric(0))
var.y_list = colnames(cor)
for(var.x in colnames(cor)){
for(var.y in var.y_list){
if(var.x != var.y){
new_row = data.frame(var.x = var.x,
var.y = var.y,
cor = cor(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs"),
p = cor.test(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs")$p.value)
if(new_row$p < 0.05 & abs(new_row$cor) > 0.15){
cor_list = rbind(cor_list, new_row)
}
}
}
var.y_list = var.y_list[-which(var.y_list == var.x)]
}
for(comp in 1:nrow(cor_list)){
var.x = cor_list[comp, "var.x"]
var.y = cor_list[comp, "var.y"]
plot = clinical_data %>% ggplot() + geom_point(aes( x = clinical_data[[var.x]], y = clinical_data[[var.y]],
alpha = 0.5),
#position = position_jitter(w = 0, h = 0),
col = '#DE2F56') +
xlab(var.x) + ylab(var.y) +
theme_minimal()
print(plot)
}
highest_cor = cor
# Keep high correlations
highest_cor[abs(cor) < 0.2] = 0
# Keep significant correlations
highest_cor[(Mtest$p) > 0.05] = 0
# Remove self correlations
highest_cor[abs(cor) == 1] = 0
cor_list = data.frame(var.x = character(0), var.y  = character(0),
cor = numeric(0), p = numeric(0))
var.y_list = colnames(cor)
for(var.x in colnames(cor)){
for(var.y in var.y_list){
if(var.x != var.y){
new_row = data.frame(var.x = var.x,
var.y = var.y,
cor = cor(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs"),
p = cor.test(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs")$p.value)
if(new_row$p < 0.05 & abs(new_row$cor) > 0.15){
cor_list = rbind(cor_list, new_row)
}
}
}
var.y_list = var.y_list[-which(var.y_list == var.x)]
}
for(comp in 1:nrow(cor_list)){
var.x = cor_list[comp, "var.x"]
var.y = cor_list[comp, "var.y"]
plot = clinical_data %>% ggplot() + geom_point(aes( x = clinical_data[[var.x]], y = clinical_data[[var.y]],
alpha = 0.5),
#position = position_jitter(w = 0, h = 0),
col = '#DE2F56') +
xlab(var.x) + ylab(var.y) +
guide(alpha = "none")+
theme_minimal()
print(plot)
}
highest_cor = cor
# Keep high correlations
highest_cor[abs(cor) < 0.2] = 0
# Keep significant correlations
highest_cor[(Mtest$p) > 0.05] = 0
# Remove self correlations
highest_cor[abs(cor) == 1] = 0
cor_list = data.frame(var.x = character(0), var.y  = character(0),
cor = numeric(0), p = numeric(0))
var.y_list = colnames(cor)
for(var.x in colnames(cor)){
for(var.y in var.y_list){
if(var.x != var.y){
new_row = data.frame(var.x = var.x,
var.y = var.y,
cor = cor(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs"),
p = cor.test(clinical_data[[var.x]], clinical_data[[var.y]],
use = "pairwise.complete.obs")$p.value)
if(new_row$p < 0.05 & abs(new_row$cor) > 0.15){
cor_list = rbind(cor_list, new_row)
}
}
}
var.y_list = var.y_list[-which(var.y_list == var.x)]
}
for(comp in 1:nrow(cor_list)){
var.x = cor_list[comp, "var.x"]
var.y = cor_list[comp, "var.y"]
plot = clinical_data %>% ggplot() + geom_point(aes( x = clinical_data[[var.x]], y = clinical_data[[var.y]],
alpha = 0.5),
#position = position_jitter(w = 0, h = 0),
col = '#DE2F56') +
xlab(var.x) + ylab(var.y) +
guides(alpha = "none")+
theme_minimal()
print(plot)
}
